generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model admin {
  admin_id   Int     @id @default(autoincrement())
  first_name String  @db.VarChar(255)
  last_name  String  @db.VarChar(255)
  mobile_no  String  @db.VarChar(12)
  user_id    Int
  isActive   Boolean
  user       user    @relation(fields: [user_id], references: [user_id], onDelete: Cascade, map: "FK TO ADMIN FROM USER")

  @@index([user_id], map: "FK TO ADMIN FROM USER")
}

/// This model has been renamed to 'Renamedclass' during introspection, because the original name 'class' is reserved.
model Renamedclass {
  class_id      Int                        @id @default(autoincrement())
  course_id     Int
  student_id    Int
  date          DateTime                   @default(now()) @db.Date
  start_time    DateTime                   @default(now()) @db.Timestamp(0)
  end_time      DateTime                   @default(now()) @db.Timestamp(0)
  status        Renamedclass_status        @default(upcoming)
  joined_time   DateTime                   @default(now()) @db.Timestamp(0)
  left_time     DateTime                   @default(now()) @db.Timestamp(0)
  online_status Renamedclass_online_status
  isActive      Boolean
  course        course                     @relation("classTocourse", fields: [course_id], references: [course_id], onDelete: Cascade, map: "FK TO CLASS FROM COURSE")
  student       student                    @relation("classTostudent", fields: [student_id], references: [student_id], onDelete: Cascade, map: "FK TO CLASS FROM STUDENT")

  @@index([course_id], map: "FK TO CLASS FROM COURSE")
  @@index([student_id], map: "FK TO CLASS FROM STUDENT")
  @@map("class")
}

model course {
  course_name      String             @db.VarChar(100)
  grade            String             @db.VarChar(3)
  subject          String             @db.VarChar(100)
  description      String             @db.VarChar(255)
  duration         Int
  start_date       DateTime           @db.Date
  start_time       DateTime           @db.Time(0)
  end_time         DateTime           @db.Time(0)
  day              course_day
  medium           course_medium
  course_id        Int                @id @default(autoincrement())
  teacher_id       Int
  price            Int
  isActive         Boolean
  teacher          teacher            @relation(fields: [teacher_id], references: [teacher_id], onDelete: NoAction, map: "FK TO COURSE FROM TEACHER")
  class            Renamedclass[]     @relation("classTocourse")
  homework         homework[]
  institute_course institute_course[]
  notes            notes[]
  student_course   student_course[]
  student_payment  student_payment[]

  @@index([teacher_id], map: "FK TO COURSE FROM TEACHER")
}

model homework {
  homework_id   Int      @id @default(autoincrement())
  uploaded_date DateTime @default(now()) @db.Date
  homework      String   @db.VarChar(1000)
  course_id     Int
  student_id    Int
  isActive      Boolean
  course        course   @relation(fields: [course_id], references: [course_id], onDelete: Cascade, map: "FK TO HOMEWORK FROM COURSE")
  student       student  @relation(fields: [student_id], references: [student_id], onDelete: Cascade, map: "FK TO HOMEWORK FROM STUDENT")

  @@index([course_id], map: "FK TO HOMEWORK FROM COURSE")
  @@index([student_id], map: "FK TO HOMEWORK FROM STUDENT")
}

model institute {
  institute_id      Int                 @id @default(autoincrement())
  institute_name    String              @db.VarChar(255)
  contact_no        String              @db.VarChar(12)
  description       String              @db.VarChar(1000)
  account_name      String              @db.VarChar(100)
  account_no        String              @db.VarChar(20)
  bank_name         String              @db.VarChar(100)
  branch_name       String              @db.VarChar(100)
  user_id           Int
  isActive          Boolean
  verification_code String              @db.VarChar(10)
  user              user                @relation(fields: [user_id], references: [user_id], onDelete: NoAction, map: "FK TO INSTITUTE FROM USER")
  institute_course  institute_course[]
  institute_teacher institute_teacher[]
  teacher_requests  teacher_requests[]

  @@index([user_id], map: "FK TO INSTITUTE FROM USER")
}

model institute_course {
  institute_id Int
  course_id    Int
  isActive     Boolean
  course       course    @relation(fields: [course_id], references: [course_id], onDelete: NoAction, map: "FK TO INS_CO FROM COURSE")
  institute    institute @relation(fields: [institute_id], references: [institute_id], onDelete: NoAction, map: "FK TO INS_CO FROM INSTITUTE")

  @@id([institute_id, course_id])
  @@index([course_id], map: "FK TO INS_CO FROM COURSE")
  @@index([institute_id], map: "FK TO INS_CO FROM INSTITUTE")
}

model institute_teacher {
  institute_id Int
  teacher_id   Int
  status       institute_teacher_status
  isActive     Boolean
  institute    institute                @relation(fields: [institute_id], references: [institute_id], onDelete: Cascade, map: "institute_teacher_ibfk_1")
  teacher      teacher                  @relation(fields: [teacher_id], references: [teacher_id], onDelete: Cascade, map: "institute_teacher_ibfk_2")

  @@id([institute_id, teacher_id])
  @@index([teacher_id], map: "teacher_id")
}

model notes {
  note_id       Int      @id @default(autoincrement())
  uploaded_date DateTime @default(now()) @db.Date
  note          String   @db.VarChar(1000)
  course_id     Int
  student_id    Int
  isActive      Boolean
  course        course   @relation(fields: [course_id], references: [course_id], onDelete: Cascade, map: "FK TO NOTE FROM COURSE")
  student       student  @relation(fields: [student_id], references: [student_id], onDelete: Cascade, map: "FK TO NOTE FROM STUDENT")

  @@index([course_id], map: "FK TO NOTE FROM COURSE")
  @@index([student_id], map: "FK TO NOTE FROM STUDENT")
}

model notification {
  notification_id Int                      @id @default(autoincrement())
  user_id         Int
  subject         String                   @db.VarChar(300)
  description     String                   @db.VarChar(10000)
  read_status     notification_read_status @default(unread)
  isActive        Boolean
  user            user                     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, map: "FK TO NOTIF FROM USER")

  @@index([user_id], map: "FK TO NOTIF FROM USER")
}

model parent {
  parent_id  Int       @id
  user_id    Int
  first_name String    @db.VarChar(100)
  last_name  String    @db.VarChar(100)
  mobile_no  String    @db.VarChar(12)
  isActive   Boolean
  user       user      @relation(fields: [user_id], references: [user_id], onDelete: NoAction, map: "FK TO PARENT FROM USER")
  student    student[]

  @@index([user_id], map: "FK TO PARENT FROM USER")
}

model parent_payment {
  payment_id      Int                  @id @default(autoincrement())
  payment_time    DateTime             @default(now()) @db.Timestamp(0)
  amount          Int
  student_id      Int
  month           parent_payment_month
  year            Int
  isActive        Boolean
  student         student              @relation(fields: [student_id], references: [student_id], onDelete: Cascade, map: "FK TO PARENT_PAYMENT FROM STUDENT")
  student_payment student_payment?

  @@index([student_id], map: "FK TO PARENT_PAYMENT FROM STUDENT")
}

model student {
  first_name      String            @db.VarChar(30)
  last_name       String            @db.VarChar(30)
  school          String            @db.VarChar(100)
  grade           String            @db.VarChar(3)
  isActive        Boolean
  student_id      Int               @id
  user_id         Int
  parent_id       Int
  parent          parent            @relation(fields: [parent_id], references: [parent_id], onDelete: Cascade, map: "FK TO STUDENT FROM PARENT")
  user            user              @relation(fields: [user_id], references: [user_id], onDelete: NoAction, map: "FK TO STUDENT FROM USER")
  class           Renamedclass[]    @relation("classTostudent")
  homework        homework[]
  notes           notes[]
  parent_payment  parent_payment[]
  student_course  student_course[]
  student_payment student_payment[]

  @@index([parent_id], map: "FK TO STUDENT FROM PARENT")
  @@index([user_id], map: "FK TO STUDENT FROM USER")
}

model student_course {
  student_id Int
  course_id  Int
  isActive   Boolean
  status     student_course_status
  course     course                @relation(fields: [course_id], references: [course_id], onDelete: NoAction, map: "FK TO STU_CO FROM COURSE")
  student    student               @relation(fields: [student_id], references: [student_id], onDelete: NoAction, map: "FK TO STU_CO FROM STUDENT")

  @@id([student_id, course_id])
  @@index([course_id], map: "FK TO STU_CO FROM COURSE")
  @@index([student_id], map: "FK TO STU_CO FROM STUDENT")
}

model student_payment {
  payment_id     Int                            @id @default(autoincrement())
  student_id     Int
  course_id      Int
  month          student_payment_month
  payment_status student_payment_payment_status
  isActive       Boolean
  course         course                         @relation(fields: [course_id], references: [course_id], onUpdate: Restrict, map: "FK TO STUDENT_PAYMENT FROM COURSE")
  parent_payment parent_payment                 @relation(fields: [payment_id], references: [payment_id], onUpdate: Restrict, map: "FK TO STUDENT_PAYMENT FROM PARENT_PAYMENT")
  student        student                        @relation(fields: [student_id], references: [student_id], onUpdate: Restrict, map: "FK TO STUDENT_PAYMENT FROM STUDENT")

  @@index([course_id], map: "FK TO STUDENT_PAYMENT FROM COURSE")
  @@index([student_id], map: "FK TO STUDENT_PAYMENT FROM STUDENT")
}

model teacher {
  teacher_id        Int                  @id @default(autoincrement())
  first_name        String               @db.VarChar(30)
  last_name         String               @db.VarChar(30)
  gender            teacher_gender
  description       String               @db.VarChar(255)
  qualification     String               @db.VarChar(255)
  account_name      String               @db.VarChar(255)
  bank_name         String               @db.VarChar(255)
  branch_name       String               @db.VarChar(100)
  account_no        String               @db.VarChar(20)
  verification      teacher_verification
  isActive          Boolean
  user_id           Int
  user              user                 @relation(fields: [user_id], references: [user_id], onDelete: NoAction, map: "FK TO TEACHER FROM USER")
  course            course[]
  institute_teacher institute_teacher[]
  teacher_requests  teacher_requests[]

  @@index([user_id], map: "FK TO TEACHER FROM USER")
}

model teacher_requests {
  institute_id   Int
  teacher_id     Int
  request_status teacher_requests_request_status @default(pending)
  date           DateTime                        @default(now()) @db.Timestamp(0)
  isActive       Boolean
  institute      institute                       @relation(fields: [institute_id], references: [institute_id], onUpdate: Restrict, map: "FK_instituteID_to_institute")
  teacher        teacher                         @relation(fields: [teacher_id], references: [teacher_id], onUpdate: Restrict, map: "FK_teacherID_to_teacher")

  @@id([institute_id, teacher_id, date])
  @@index([teacher_id], map: "FK_teacherID_to_teacher")
}

model user {
  user_id       Int            @id @default(autoincrement())
  username      String         @unique(map: "username") @db.VarChar(50)
  type          user_type      @default(student)
  profile_image String         @db.VarChar(255)
  isActive      Boolean
  admin         admin[]
  institute     institute[]
  notification  notification[]
  parent        parent[]
  student       student[]
  teacher       teacher[]
}

enum Renamedclass_status {
  upcoming
  ended
  cancelled

  @@map("class_status")
}

enum Renamedclass_online_status {
  online
  offline

  @@map("class_online_status")
}

enum course_day {
  SUN
  MON
  TUE
  WED
  THU
  FRI
  SAT
}

enum course_medium {
  Sinhala
  English
  Tamil
}

enum institute_teacher_status {
  active
  inactive
}

enum notification_read_status {
  read
  unread
}

enum parent_payment_month {
  Jan
  Feb
  Mar
  Apr
  May
  Jun
  Jul
  Aug
  Sep
  Oct
  Nov
  Dec
}

enum student_course_status {
  accepted
  pending
  rejected
}

enum student_payment_month {
  Jan
  Feb
  Mar
  Apr
  May
  Jun
  Jul
  Aug
  Sep
  Oct
  Nov
  Dec
}

enum student_payment_payment_status {
  paid
  unpaid
}

enum teacher_gender {
  male
  female
}

enum teacher_verification {
  pending
  verified
  rejected
}

enum teacher_requests_request_status {
  accepted
  rejected
  pending
}

enum user_type {
  student
  parent
  teacher
  institute
  admin
}
